<!DOCTYPE html>
<html>
<head>
  <title>Billing - CourierPro</title>
  <link rel="stylesheet" href="static/style.css">
</head>
<body>
  <div class="navbar">
    <div>Billing</div>
    <div><a href="dashboard.html">Back to Dashboard</a></div>
  </div>

  

  <h2>Make Payment by Tracking Number</h2>
<input id="trackBillId" placeholder="Tracking Number">
<button onclick="payByTracking()">Pay</button>
<p id="payMsg"></p>

  <script>
    function payByTracking() {
  const id = document.getElementById("trackBillId").value;
  fetch(`/make-payment/${id}`, {
    method: "POST"
  }).then(res => res.json()).then(data => {
    document.getElementById("payMsg").textContent = data.message;
  });
}
    window.onload = () => {
      fetch("/api/customers").then(res => res.json()).then(data => {
        const sel = document.getElementById("custDropdown");
        data.forEach(c => {
          const opt = document.createElement('option');
          opt.value = c.customer_id;
          opt.textContent = `${c.name} (${c.email})`;
          sel.appendChild(opt);
        });
      });
    };

    function generate() {
      const id = document.getElementById("custDropdown").value;
      fetch(`/generate-bill/${id}`, { method: "POST" }).then(() => {
        fetch(`/billing/${id}`).then(res => res.json()).then(data => {
          document.getElementById("result").textContent =
            `Customer #${data.customer_id} has a total bill of â‚¹${data.total_due}`;
        });
      });
    }
  </script>
</body>
</html>
