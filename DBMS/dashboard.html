<!DOCTYPE html>
<html>
<head>
  <title>Dashboard - CourierPro</title>
  <link rel="stylesheet" href="static/style.css">
</head>
<body>
  <div class="navbar">
    <div>CourierPro Dashboard</div>
    <div>
      <a href="billing.html">Billing</a>
      <a href="#" onclick="logout()">Logout</a>
    </div>
  </div>

  <div class="container">
    <h2>Create New Courier</h2>

    <h3>Sender (Customer) Info</h3>
    <input id="custFName" placeholder="First Name">
    <input id="custLName" placeholder="Last Name">
    <input id="custPhone" placeholder="Phone">
    <input id="custEmail" placeholder="Email">
    <input id="custAddr" placeholder="Address">

    <h3>Recipient Info</h3>
    <input id="recFName" placeholder="First Name">
    <input id="recLName" placeholder="Last Name">
    <input id="recPhone" placeholder="Phone">
    <input id="recEmail" placeholder="Email">
    <input id="recAddr" placeholder="Address">

    <h3>Package Info</h3>
    <input id="packType" placeholder="Type">
    <input id="packWeight" placeholder="Weight (kg)">
    <select id="packPriority">
      <option value="High">High</option>
      <option value="Medium">Medium</option>
      <option value="Low">Low</option>
    </select>
    <select id="packStatus">
      <option value="Pending">Pending</option>
      <option value="In Transit">In Transit</option>
      <option value="Delivered">Delivered</option>
    </select>

    <button onclick="submitCourier()">Create Courier</button>

    <h3>Track Courier</h3>
    <input id="trackId" placeholder="Tracking Number">
    <button onclick="track()">Track</button>
    <p id="trackResult"></p>

    <h3>All Couriers</h3>
    <button onclick="getAll()">Refresh</button>
    <div id="courierList"></div>
  </div>

<script>
  function logout() {
    localStorage.clear();
    window.location.href = "/";
  }

  function submitCourier() {
    const data = {
      customer: {
        first_name: document.getElementById("custFName").value,
        last_name: document.getElementById("custLName").value,
        phone: document.getElementById("custPhone").value,
        email: document.getElementById("custEmail").value,
        address: document.getElementById("custAddr").value
      },
      recipient: {
        first_name: document.getElementById("recFName").value,
        last_name: document.getElementById("recLName").value,
        phone: document.getElementById("recPhone").value,
        email: document.getElementById("recEmail").value,
        address: document.getElementById("recAddr").value
      },
      package: {
        type: document.getElementById("packType").value,
        weight: document.getElementById("packWeight").value,
        priority: document.getElementById("packPriority").value,
        status: document.getElementById("packStatus").value
      }
    };

    fetch("/create-courier", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data)
    }).then(res => res.json()).then(result => {
      alert(result.message || "Courier created");
    });
  }

  function track() {
    const tracking = document.getElementById("trackId").value;
    fetch(`/track/${tracking}`)
      .then(res => res.json())
      .then(data => {
        document.getElementById("trackResult").textContent =
          data.success ? JSON.stringify(data.courier) : "Not found";
      });
  }

  function getAll() {
    fetch("/couriers")
      .then(res => res.json())
      .then(data => {
        const list = document.getElementById("courierList");
        list.innerHTML = data.map(c => `<div>#${c.courier_id} | ${c.status}</div>`).join('');
      });
  }
</script>
</body>
</html>